digraph G {
    #########
    # SETUP #
    #########

    compound = true
    fontname = "Helvetica"

    edge [
        colorscheme = "piyg11"
        fontname = "Helvetica"
    ];

    node [
        shape = box
        colorscheme = "piyg11"
        style = filled
        fillcolor = 7
        fontname = "Helvetica"
        color=10
        fontcolor=10
    ];

    graph [
        colorscheme = "piyg11"
        color = 10
        style = "rounded,filled"
        fontcolor=7
    ];

    ############
    # CLUSTERS #
    ############

    subgraph cluster_index {
        label = "Index"

        color = 2
        fillcolor = 2
        fontcolor = 5

        hashed_namefilter [
            label = "Hashed Namefilter"

            color = 2
            fillcolor = 5
            fontcolor = 2
        ]
    }

    subgraph cluster_bucket {
        label = "Bucket"

        expanded_namefilter [label = "Expanded Namefilter"]

        ellipsis_start [label = "..." fontcolor = 7 shape = plaintext fillcolor = invis color = invis]
        ciphertext_a [label = "Ciphertext A" shape = note]
        ciphertext_b [label = "Ciphertext B" shape = note]
        ciphertext_c [label = "Ciphertext C" shape = note]
        ellipsis_end [label = "..." fontcolor = 7 shape = plaintext fillcolor = 10]

        expanded_namefilter -> { ellipsis_start ciphertext_a ciphertext_b ciphertext_c ellipsis_end} [style = invis]
    }

    hashed_namefilter -> expanded_namefilter [
        ltail = cluster_index
        lhead = cluster_bucket
        minlen = 2
        color = 2
    ]

    expanded_namefilter:w -> hashed_namefilter:w [
        xlabel = "Hash"
        fontcolor = 11
        color = 11
        style = dashed
    ]
}
